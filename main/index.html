<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hong Kong Live Dashboard</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { 
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif; 
            background: linear-gradient(135deg, #0f0f23, #1a1a2e); 
            color: #e0e0e0; min-height: 100vh; padding-top: 2rem;
        }
        .header { 
            background: linear-gradient(135deg, #1e3c72, #2a5298); 
            padding: 1.5rem; text-align: center; box-shadow: 0 4px 20px rgba(0,0,0,0.3);
            margin: 0 2rem; border-radius: 0 0 24px 24px;
        }
        
        .hero-section { 
            display: grid; grid-template-columns: 1fr 3.5fr; gap: 2rem; 
            max-width: 1400px; margin: 2rem auto; padding: 0 2rem; 
        }
        
        .weather-hero { 
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); 
            border-radius: 24px; padding: 2.5rem 2rem; height: 320px; 
            box-shadow: 0 12px 40px rgba(102,126,234,0.4); 
            display: flex; flex-direction: column; justify-content: center; text-align: center;
            position: relative; overflow: hidden;
        }
        .weather-hero::before { content: 'üå§Ô∏è'; font-size: 5rem; position: absolute; top: -20px; right: -20px; opacity: 0.2; }
        
        .news-hero { 
            background: rgba(30,30,30,0.9); border-radius: 24px; padding: 2.5rem; 
            box-shadow: 0 12px 40px rgba(0,0,0,0.5); overflow-y: auto; max-height: 320px; 
            backdrop-filter: blur(10px);
        }
        
        .hero-title { color: #ffffff; font-size: 1.5rem; font-weight: 700; margin-bottom: 1.2rem; }
        .weather-temp { font-size: 4.2rem; font-weight: 300; color: #ffffff; margin-bottom: 0.8rem; letter-spacing: -2px; }
        .weather-desc { font-size: 1.5rem; color: #e8f4fd; margin-bottom: 1rem; font-weight: 500; }
        .weather-details { font-size: 1.1rem; color: #b3d9ff; }
        .weather-warning { background: linear-gradient(45deg, #ff6b6b, #ff8e53); color: white; padding: 0.8rem 1.5rem; border-radius: 50px; font-weight: 600; margin-top: 1.2rem; font-size: 1rem; }
        
        .news-item { 
            padding: 1.2rem 0; border-bottom: 1px solid #444; cursor: pointer; 
            transition: all 0.3s ease; display: flex; align-items: flex-start; gap: 1rem; 
        }
        .news-item:hover { 
            background: rgba(76,175,80,0.2); border-radius: 16px; padding-left: 1.5rem; 
            transform: translateX(8px); border-left: 4px solid #4caf50; 
        }
        .news-content { flex: 1; }
        .news-title { color: #ffffff; font-weight: 600; font-size: 1.1rem; line-height: 1.4; margin-bottom: 0.4rem; }
        .news-source { color: #ff6b6b; font-size: 0.95rem; font-weight: 700; }
        .news-time { color: #888; font-size: 0.85rem; margin-top: 0.2rem; }
        
        /* Ê®°ÊÖãÂΩàÁ™ó */
        .modal { 
            display: none; position: fixed; z-index: 2000; left: 0; top: 0; 
            width: 100%; height: 100%; background-color: rgba(0,0,0,0.8); 
        }
        .modal-content { 
            background: #1e1e1e; margin: 5% auto; padding: 2rem; border-radius: 16px; 
            width: 90%; max-width: 600px; max-height: 80vh; overflow-y: auto; 
            box-shadow: 0 20px 60px rgba(0,0,0,0.8);
        }
        .close { color: #aaa; float: right; font-size: 2rem; font-weight: bold; cursor: pointer; }
        .close:hover { color: #ffffff; }
        .modal-url { word-break: break-all; background: #2a2a2a; padding: 1rem; border-radius: 8px; margin-top: 1rem; }
        .news-link { color: #4caf50 !important; text-decoration: underline; font-size: 0.85rem; }
        
        @media (max-width: 1100px) { 
            .hero-section { grid-template-columns: 1fr; gap: 1.5rem; } 
            body { padding-top: 1rem; }
        }
    </style>
</head>
<body>
    <header class="header">
        <h1>üá≠üá∞ Hong Kong Live Dashboard</h1>
        <p>Hong Kong Observatory Weather + Hong Kong Herald News</p>
    </header>

    <section class="hero-section">
        <!-- Â§©Ê∞£ -->
        <div class="weather-hero">
            <div class="hero-title">üå§Ô∏è HK Observatory</div>
            <div class="weather-temp" id="weatherTemp">--¬∞C</div>
            <div class="weather-desc" id="weatherDesc">--</div>
            <div class="weather-details" id="weatherDetails">Loading...</div>
            <div id="weatherWarning"></div>
        </div>
        
        <!-- Âè™Áî®Hong Kong Herald RSS -->
        <div class="news-hero">
            <div class="hero-title">üì∞ Hong Kong Herald <span id="newsCount"></span></div>
            <div id="heroNews">Loading Hong Kong Herald RSS...</div>
        </div>
    </section>

    <!-- Ê®°ÊÖãÂΩàÁ™ó -->
    <div id="linkModal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h3>Hong Kong Herald Article</h3>
            <p>Click to open in new tab:</p>
            <div class="modal-url" id="modalUrl"></div>
        </div>
    </div>

    <script>
        // üî• Âè™Áî®Â§©ÊñáÂè∞ÂÆòÊñπRSS
        async function updateWeather() {
            try {
                const response = await fetch('https://rss.weather.gov.hk/rss/CurrentWeather.xml');
                const text = await response.text();
                const parser = new DOMParser();
                const xmlDoc = parser.parseFromString(text, "text/xml");
                const items = xmlDoc.querySelectorAll('item');
                
                if (items.length > 0) {
                    const desc = items[0].querySelector('description').textContent;
                    const tempMatch = desc.match(/(\d+)\s+degr(?:ees|e)/i);
                    const humidityMatch = desc.match(/Relative Humidity\s*:\s*(\d+)/i);
                    
                    const temp = tempMatch ? tempMatch[1] : '--';
                    const humidity = humidityMatch ? humidityMatch[1] : '--';
                    
                    document.getElementById('weatherTemp').textContent = `${temp}¬∞C`;
                    document.getElementById('weatherDesc').textContent = `${humidity}% RH`;
                    document.getElementById('weatherDetails').textContent = `HK Observatory ‚Ä¢ ${new Date().toLocaleString('en-GB', {timeZone: 'Asia/Hong_Kong'})}`;
                }
            } catch (e) {
                // Silent fail
            }
        }

        // üî• Âè™Áî®Hong Kong Herald RSSÔºà‰Ω†ÊåáÂÆöÔºâ
        async function updateNews() {
            try {
                const response = await fetch('https://feeds.hongkongherald.com/rss/b82693edf38ebff8');[attached_file:1]
                const text = await response.text();
                const parser = new DOMParser();
                const xmlDoc = parser.parseFromString(text, "text/xml");
                const items = xmlDoc.querySelectorAll('item');
                
                let newsHtml = '';
                let count = 0;
                
                Array.from(items).slice(0, 12).forEach(item => {
                    const titleEl = item.querySelector('title');
                    const linkEl = item.querySelector('link');
                    const pubDateEl = item.querySelector('pubDate');
                    
                    if (titleEl && linkEl && titleEl.textContent.trim()) {
                        const title = titleEl.textContent.trim().substring(0, 85) + (titleEl.textContent.length > 85 ? '...' : '');
                        const link = linkEl.textContent.trim();
                        const pubDate = pubDateEl ? new Date(pubDateEl.textContent) : new Date();
                        
                        newsHtml += `
                            <div class="news-item" onclick="openLinkModal('${link}', '${title.replace(/'/g, "\\'").replace(/"/g, '\\"')}')">
                                <div class="news-content">
                                    <div class="news-title">${title}</div>
                                    <div class="news-source">Hong Kong Herald</div>
                                    <div class="news-time">${pubDate.toLocaleDateString('en-GB')}</div>
                                </div>
                            </div>
                        `;
                        count++;
                    }
                });
                
                document.getElementById('heroNews').innerHTML = newsHtml || '';
                document.getElementById('newsCount').textContent = `(${count})`;
                
            } catch (e) {
                // Silent fail
            }
        }

        // üî• Ê®°ÊÖãÂΩàÁ™óÔºàHong Kong HeraldÂ∞àÁî®Ôºâ
        function openLinkModal(url, title) {
            document.getElementById('modalUrl').innerHTML = 
                `<strong>${title}</strong><br><a href="${url}" target="_blank" class="news-link">üîó Open Hong Kong Herald Article</a>`;
            document.getElementById('linkModal').style.display = 'block';
        }

        // ÈóúÈñâÂΩàÁ™ó
        window.onclick = function(event) {
            const modal = document.getElementById('linkModal');
            if (event.target == modal) modal.style.display = 'none';
        }
        document.addEventListener('DOMContentLoaded', function() {
            document.querySelector('.close').onclick = function() {
                document.getElementById('linkModal').style.display = 'none';
            }
        });

        // ÂïüÂãï
        updateWeather();
        updateNews();
        setInterval(() => {
            updateWeather();
            updateNews();
        }, 5 * 60 * 1000); // 5ÂàÜÈêò
    </script>
</body>
</html>

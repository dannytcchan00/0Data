<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hong Kong Live Data</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { 
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif; 
            background: linear-gradient(135deg, #0f0f23, #1a1a2e); 
            color: #e0e0e0; min-height: 100vh; padding: 20px;
        }
        .container { 
            max-width: 1200px; margin: 0 auto; display: grid; 
            grid-template-columns: 1fr 3fr; gap: 30px; height: calc(100vh - 40px);
        }
        .weather-card { 
            background: rgba(30,30,60,0.8); border-radius: 20px; padding: 30px; 
            backdrop-filter: blur(10px); border: 1px solid rgba(255,255,255,0.1);
        }
        .news-card { 
            background: rgba(20,20,50,0.8); border-radius: 20px; padding: 30px; 
            backdrop-filter: blur(10px); border: 1px solid rgba(255,255,255,0.1);
            overflow-y: auto; max-height: 80vh;
        }
        .temp { font-size: 4rem; font-weight: 300; margin-bottom: 10px; }
        .weather-icon { font-size: 3rem; margin: 10px 0; }
        .status { font-size: 0.9rem; opacity: 0.8; margin-top: 20px; }
        .news-item { 
            padding: 15px; margin-bottom: 12px; border-radius: 12px; 
            background: rgba(40,40,80,0.6); cursor: pointer; transition: all 0.3s;
            border-left: 4px solid #4a90e2;
        }
        .news-item:hover { background: rgba(60,60,100,0.8); transform: translateX(5px); }
        .news-title { font-size: 1.1rem; margin-bottom: 5px; }
        .news-source { font-size: 0.85rem; opacity: 0.7; }
        .modal { 
            display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; 
            background: rgba(0,0,0,0.9); z-index: 1000; 
        }
        .modal-content { 
            position: absolute; top: 50%; left: 50%; transform: translate(-50%,-50%); 
            background: #1a1a2e; padding: 30px; border-radius: 15px; max-width: 500px;
            text-align: center;
        }
        @media (max-width: 768px) { 
            .container { grid-template-columns: 1fr; gap: 20px; height: auto; }
            .temp { font-size: 3rem; }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="weather-card" id="weather">
            <div class="temp">--¬∞C</div>
            <div class="weather-icon" id="weather-icon">üå§Ô∏è</div>
            <div id="weather-details">--</div>
            <div class="status" id="weather-status">Loading OpenWeatherMap...</div>
        </div>
        <div class="news-card" id="news">
            <div style="font-size:1.2rem; margin-bottom:20px;">üì∞ Latest News</div>
            <div id="news-list">Loading Hong Kong Herald...</div>
        </div>
    </div>
    
    <div id="modal" class="modal">
        <div class="modal-content">
            <h3 id="modal-title">News Link</h3>
            <p id="modal-url"></p>
            <a id="modal-link" href="#" target="_blank" style="color:#4a90e2; font-size:1.1rem;">üîó Open in new tab</a>
            <br><br>
            <button onclick="closeModal()" style="background:#333; color:white; border:none; padding:10px 20px; border-radius:8px; cursor:pointer;">Close</button>
        </div>
    </div>

    <script>
        const API_KEY = 'f19c9c1cfbb572c048a0a99c38f012d2';
        
        // Â§©Ê∞£ÔºöOpenWeatherMap API (È¶ôÊ∏Ø‰∏≠ÂøÉ)
        async function updateWeather() {
            try {
                const res = await fetch(`https://api.openweathermap.org/data/2.5/weather?lat=22.3964&lon=114.1095&appid=${API_KEY}&units=metric&lang=en`);
                const data = await res.json();
                
                const temp = Math.round(data.main.temp);
                const feelsLike = Math.round(data.main.feels_like);
                const humidity = data.main.humidity;
                const desc = data.weather[0].description;
                const iconCode = data.weather[0].icon;
                const updateTime = new Date().toLocaleTimeString('en-GB', {timeZone: 'Asia/Hong_Kong'});
                
                // Â§©Ê∞£ÂúñÁ§∫Êò†Â∞Ñ
                const iconMap = {
                    '01d': '‚òÄÔ∏è', '01n': 'üåô', '02d': '‚õÖ', '02n': '‚òÅÔ∏è',
                    '03d': '‚òÅÔ∏è', '03n': '‚òÅÔ∏è', '04d': '‚òÅÔ∏è', '04n': '‚òÅÔ∏è',
                    '09d': 'üå¶Ô∏è', '09n': 'üå¶Ô∏è', '10d': 'üåßÔ∏è', '10n': 'üåßÔ∏è',
                    '11d': '‚õàÔ∏è', '11n': '‚õàÔ∏è', '13d': '‚ùÑÔ∏è', '13n': '‚ùÑÔ∏è',
                    '50d': 'üå´Ô∏è', '50n': 'üå´Ô∏è'
                };
                const icon = iconMap[iconCode] || 'üå§Ô∏è';
                
                document.querySelector('.temp').textContent = `${temp}¬∞C`;
                document.getElementById('weather-icon').textContent = icon;
                document.getElementById('weather-details').textContent = `${desc} ‚Ä¢ Feels like ${feelsLike}¬∞C ‚Ä¢ ${humidity}% RH`;
                document.getElementById('weather-status').textContent = `OpenWeatherMap ${updateTime}`;
            } catch(e) {
                document.getElementById('weather-status').textContent = 'Weather API unavailable';
                console.error('Weather API error:', e);
            }
        }

        // Êñ∞ËÅûÔºöHong Kong Herald RSSÔºà‰øùÊåÅ‰∏çËÆäÔºâ
        async function updateNews() {
            try {
                const res = await fetch('https://feeds.hongkongherald.com/rss/b82693edf38ebff8', {mode:'cors'});
                const text = await res.text();
                const parser = new DOMParser();
                const xml = parser.parseFromString(text, 'text/xml');
                const items = Array.from(xml.querySelectorAll('item')).slice(0,12);
                
                let html = '';
                items.forEach(item => {
                    const title = item.querySelector('title').textContent.slice(0,85) + (item.querySelector('title').textContent.length > 85 ? '...' : '');
                    const link = item.querySelector('link').textContent;
                    const source = 'Hong Kong Herald';
                    html += `<div class="news-item" onclick="showModal('${title.replace(/'/g, "\\'")}', '${link}', '${source}')">
                        <div class="news-title">${title}</div>
                        <div class="news-source">${source}</div>
                    </div>`;
                });
                document.getElementById('news-list').innerHTML = html || 'No news available';
            } catch(e) {
                document.getElementById('news-list').innerHTML = 'News feed unavailable';
                console.error('News RSS error:', e);
            }
        }

        function showModal(title, url, source) {
            document.getElementById('modal-title').textContent = title;
            document.getElementById('modal-url').textContent = `${source}: ${url}`;
            document.getElementById('modal-link').href = url;
            document.getElementById('modal').style.display = 'block';
        }

        function closeModal() {
            document.getElementById('modal').style.display = 'none';
        }

        // ÂïüÂãï + Ëá™ÂãïÊõ¥Êñ∞ÔºàÊØè5ÂàÜÈêòÔºâ
        updateWeather(); updateNews();
        setInterval(() => { updateWeather(); updateNews(); }, 5*60*1000);
    </script>
</body>
</html>
